table HourAggregation
	lineageTag: b20206a8-76b9-463d-b718-cec699216ae5

	calculationGroup
		precedence: 40

		calculationItem None = SELECTEDMEASURE()

		calculationItem 'Sum By Hour' = ```
				
				Var Categories =
				    VALUES('F_Sales'[Hour])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[HourAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Sum])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        SUMX(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Average By Hour' = ```
				
				Var Categories =
				    VALUES('F_Sales'[Hour])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[HourAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Average])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        AVERAGEX(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Weighted Average By Hour' = ```
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[HourAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Average])
				
				VAR Categories =
				    SUMMARIZE(
				        'F_Sales',
				        'D_Time'[Hour],
				        "MeasureValue", SELECTEDMEASURE(),
				        "Weight", SUM('F_Sales'[sales])
				    )
				
				VAR WeightedAverageEvaluation =
				    DIVIDE(
				        SUMX(Categories, [MeasureValue] * [Weight]),
				        SUMX(Categories, [Weight])
				    )
				
				RETURN
				    IF(
				        InclusionCheck,
				        WeightedAverageEvaluation,
				        SELECTEDMEASURE()
				    )
				```

		calculationItem 'Median By Hour' = ```
				
				VAR Categories =
				    VALUES ( 'F_Sales'[Hour] )
				
				VAR CalcByCategory =
				    ADDCOLUMNS (
				        Categories,
				        "MeasureValue", CALCULATE ( SELECTEDMEASURE () )
				    )
				
				VAR CalcByCategory_NoBlanks =
				    FILTER ( CalcByCategory, NOT ISBLANK ( [MeasureValue] ) )
				
				VAR InclusionCheck =
				    SELECTEDMEASURENAME () IN VALUES ( 'Calculation Group Inclusion'[HourAggregation] ) &&
				    SELECTEDMEASURENAME () IN VALUES ( 'Aggregation Type Inclusion'[Median] )
				
				VAR MeasureEvaluation =
				    IF (
				        InclusionCheck,
				        MEDIANX ( CalcByCategory_NoBlanks, [MeasureValue] ),
				        SELECTEDMEASURE ()
				    )
				
				RETURN
				    MeasureEvaluation
				
				```

		calculationItem 'Weighted Median By Hour' = ```
				
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[HourAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Median])
				
				Var Categories =
				    ADDCOLUMNS(
				        SUMMARIZE(
				            'F_Sales',
				            'D_Time'[Hour],
				            "MeasureValue", SELECTEDMEASURE(),
				            "Weight", SUM('F_Sales'[sales])
				        ),
				        "InnerSort", [MeasureValue]
				    )
				
				VAR TotalWeight =
				    SUMX(Categories, [Weight])
				
				VAR HalfWeight =
				    TotalWeight / 2
				
				Var WeightedTable =
				    ADDCOLUMNS(
				        Categories,
				        "CumulativeWeight",
				            VAR CurrentValue = [InnerSort]
				            RETURN
				                SUMX(
				                    FILTER(Categories, [InnerSort] <= CurrentValue),
				                    [Weight]
				                )
				    )
				
				VAR WeightedEvaluation =
				    MINX(
				        FILTER(WeightedTable, [CumulativeWeight] >= HalfWeight),
				        [InnerSort]
				    )
				
				RETURN
				    IF(
				        InclusionCheck,
				        WeightedEvaluation,
				        SELECTEDMEASURE()
				    )
				```

		calculationItem 'Max By Hour' = ```
				
				Var Categories =
				    VALUES('F_Sales'[Hour])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[HourAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Max])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        MAXX(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Min By Hour' = ```
				
				Var Categories =
				    VALUES('F_Sales'[Hour])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[HourAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Min])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        MINX(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Sdev By Hour' = ```
				
				Var Categories =
				    VALUES('F_Sales'[Hour])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[HourAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Sdev])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        STDEVX.P(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Weighted Sdev By Hour' = ```
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[HourAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Sdev])
				
				Var Categories =
				    ADDCOLUMNS(
				        SUMMARIZE(
				            'F_Sales',
				            'D_Time'[Hour],
				            "MeasureValue", SELECTEDMEASURE(),
				            "Weight", SUM('F_Sales'[sales])
				        ),
				        "InnerSort", [MeasureValue]
				    )
				
				VAR TotalWeight =
				    SUMX(Categories, [Weight])
				
				VAR WeightedMean =
				    DIVIDE(
				        SUMX(Categories, [Weight] * [MeasureValue]),
				        TotalWeight
				    )
				
				VAR WeightedEvaluation =
				    SQRT(
				        DIVIDE(
				            SUMX(
				                Categories,
				                [Weight] * POWER([MeasureValue] - WeightedMean, 2)
				            ),
				            TotalWeight
				        )
				    )
				
				RETURN
				    IF(
				        InclusionCheck,
				        WeightedEvaluation,
				        SELECTEDMEASURE()
				    )
				```

	column 'Hour Aggregation'
		dataType: string
		lineageTag: e35084a5-e0fa-4f47-9e6c-811b3a68fc92
		summarizeBy: none
		sourceColumn: Name
		sortByColumn: Ordinal

		annotation SummarizationSetBy = Automatic

	column Ordinal
		dataType: int64
		formatString: 0
		lineageTag: 25301632-0880-4d3d-bbaa-6394ce42ede0
		summarizeBy: sum
		sourceColumn: Ordinal

		annotation SummarizationSetBy = Automatic

