table PersonAggregationTemporalFirst
	lineageTag: d2a948d7-bd1b-4530-8a87-19cfc71ead69

	calculationGroup
		precedence: 140

		calculationItem None = SELECTEDMEASURE()

		calculationItem 'Sum By Person' = ```
				
				Var Categories =
				    VALUES('D_Salesperson'[Name])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[PersonAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Sum])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        SUMX(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Average By Person' = ```
				
				Var Categories =
				    VALUES('D_Salesperson'[Name])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[PersonAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Average])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        AVERAGEX(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Weighted Average By Person' = ```
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[PersonAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Average])
				
				VAR Categories =
				    SUMMARIZE(
				        'F_Sales',
				        'D_Salesperson'[person_id],
				        "MeasureValue", SELECTEDMEASURE(),
				        "Weight", SUM('F_Sales'[sales])
				    )
				
				VAR WeightedAverageEvaluation =
				    DIVIDE(
				        SUMX(Categories, [MeasureValue] * [Weight]),
				        SUMX(Categories, [Weight])
				    )
				
				RETURN
				    IF(
				        InclusionCheck,
				        WeightedAverageEvaluation,
				        SELECTEDMEASURE()
				    )
				```

		calculationItem 'Median By Person' = ```
				
				VAR Categories =
				    VALUES ( 'D_Salesperson'[person_id] )
				
				VAR CalcByCategory =
				    ADDCOLUMNS (
				        Categories,
				        "MeasureValue", CALCULATE ( SELECTEDMEASURE () )
				    )
				
				VAR CalcByCategory_NoBlanks =
				    FILTER ( CalcByCategory, NOT ISBLANK ( [MeasureValue] ) )
				
				VAR InclusionCheck =
				    SELECTEDMEASURENAME () IN VALUES ( 'Calculation Group Inclusion'[PersonAggregation] ) &&
				    SELECTEDMEASURENAME () IN VALUES ( 'Aggregation Type Inclusion'[Median] )
				
				VAR MeasureEvaluation =
				    IF (
				        InclusionCheck,
				        MEDIANX ( CalcByCategory_NoBlanks, [MeasureValue] ),
				        SELECTEDMEASURE ()
				    )
				
				RETURN
				    MeasureEvaluation
				
				```

		calculationItem 'Weighted Median By Person' = ```
				
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[PersonAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Median])
				
				Var Categories =
				    ADDCOLUMNS(
				        SUMMARIZE(
				            'F_Sales',
				            'D_Salesperson'[person_id],
				            "MeasureValue", SELECTEDMEASURE(),
				            "Weight", SUM('F_Sales'[sales])
				        ),
				        "InnerSort", [MeasureValue]
				    )
				
				VAR TotalWeight =
				    SUMX(Categories, [Weight])
				
				VAR HalfWeight =
				    TotalWeight / 2
				
				Var WeightedTable =
				    ADDCOLUMNS(
				        Categories,
				        "CumulativeWeight",
				            VAR CurrentValue = [InnerSort]
				            RETURN
				                SUMX(
				                    FILTER(Categories, [InnerSort] <= CurrentValue),
				                    [Weight]
				                )
				    )
				
				VAR WeightedEvaluation =
				    MINX(
				        FILTER(WeightedTable, [CumulativeWeight] >= HalfWeight),
				        [InnerSort]
				    )
				
				RETURN
				    IF(
				        InclusionCheck,
				        WeightedEvaluation,
				        SELECTEDMEASURE()
				    )
				```

		calculationItem 'Max By Person' = ```
				
				Var Categories =
				    VALUES('D_Salesperson'[Name])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[PersonAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Max])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        MAXX(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Min By Person' = ```
				
				Var Categories =
				    VALUES('D_Salesperson'[Name])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[PersonAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Min])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        MINX(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Sdev By Person' = ```
				
				Var Categories =
				    VALUES('D_Salesperson'[Name])
				
				Var CalcByCategory =
				    ADDCOLUMNS(
				        Categories,
				        "MeasureValue", CALCULATE(SELECTEDMEASURE())
				    )
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[PersonAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Sdev])
				
				VAR MeasureEvaluation =
				    IF(
				        InclusionCheck,
				        STDEVX.P(CalcByCategory, [MeasureValue]),
				        SELECTEDMEASURE()
				    )
				    
				RETURN
				    MeasureEvaluation
				```

		calculationItem 'Weighted Sdev By Person' = ```
				
				VAR InclusionCheck = SELECTEDMEASURENAME() IN VALUES('Calculation Group Inclusion'[PersonAggregation]) && 
				                     SELECTEDMEASURENAME() IN VALUES('Aggregation Type Inclusion'[Sdev])
				
				Var Categories =
				    ADDCOLUMNS(
				        SUMMARIZE(
				            'F_Sales',
				            'D_Salesperson'[person_id],
				            "MeasureValue", SELECTEDMEASURE(),
				            "Weight", SUM('F_Sales'[sales])
				        ),
				        "InnerSort", [MeasureValue]
				    )
				
				VAR TotalWeight =
				    SUMX(Categories, [Weight])
				
				VAR WeightedMean =
				    DIVIDE(
				        SUMX(Categories, [Weight] * [MeasureValue]),
				        TotalWeight
				    )
				
				VAR WeightedEvaluation =
				    SQRT(
				        DIVIDE(
				            SUMX(
				                Categories,
				                [Weight] * POWER([MeasureValue] - WeightedMean, 2)
				            ),
				            TotalWeight
				        )
				    )
				
				RETURN
				    IF(
				        InclusionCheck,
				        WeightedEvaluation,
				        SELECTEDMEASURE()
				    )
				```

	column 'Person Aggregation'
		dataType: string
		lineageTag: bbfb553c-1483-4b66-b5bd-05e45d8101c1
		summarizeBy: none
		sourceColumn: Name
		sortByColumn: Ordinal

		annotation SummarizationSetBy = Automatic

	column Ordinal
		dataType: int64
		formatString: 0
		lineageTag: 3e4bad60-b8a4-4a39-85b0-48ff8f903fa1
		summarizeBy: sum
		sourceColumn: Ordinal

		annotation SummarizationSetBy = Automatic

